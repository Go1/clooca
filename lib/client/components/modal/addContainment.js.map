{"version":3,"sources":["client/components/modal/addContainment.js"],"names":["React","require","Modal","customStyles","content","top","left","right","bottom","marginRight","transform","backgroundColor","color","CreateModal","createClass","getInitialState","containments","selectedContainment","modalIsOpen","afterOpenModal","closeModal","props","onClose","okModal","model","resourceSet","association","refs","value","eclass","name","eClass","elements","filter","get","add","create","componentWillReceiveProps","nextProps","map","asso","eType","superTypes","eSuperType","length","superTypeNames","superType","eTypes","setState","onAssociationChange","render","options","state","containment","options2","eTypeName","isOpen","module","exports"],"mappings":"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","file":"addContainment.js","sourcesContent":["var React = require('react');\nvar Modal = require('react-modal');\n\nconst customStyles = {\n  content : {\n    top                   : '50%',\n    left                  : '50%',\n    right                 : 'auto',\n    bottom                : 'auto',\n    marginRight           : '-50%',\n    transform             : 'translate(-50%, -50%)',\n    backgroundColor       : '#272525',\n    color                 : '#fff'\n  }\n};\n\n\nvar CreateModal = React.createClass({\n\n  getInitialState: function() {\n    return {\n    \tcontainments: [],\n      selectedContainment: null,\n    \tmodalIsOpen: false\n    };\n  },\n\n  afterOpenModal: function() {\n\n  },\n\n  closeModal: function() {\n  \tthis.props.onClose();\n  },\n\n  okModal: function() {\n    var model = this.props.model;\n    var resourceSet = this.props.resourceSet;\n  \tvar association = this.refs.association.value;\n    var eclass = this.refs.eclass.value;\n  \tvar name = this.refs.name.value;\n    var eClass = resourceSet.elements('EClass').filter((eClass) => {\n      return eClass.get('name') == eclass;\n    })[0];\n  \tmodel.get(association).add(eClass.create({name:name}));\n  \tthis.props.onClose();\n  },\n\n  componentWillReceiveProps: function(nextProps) {\n    //eClass assoname\n  \tvar model = nextProps.model;\n    if(!model) return;\n    var resourceSet = nextProps.resourceSet;\n  \tvar containments = model.eClass.get('eAllContainments').map(function(asso) {\n      let eType = asso.get('eType');\n      if(eType.get('abstract') || eType.get('interface')) {\n        var superTypes = resourceSet.elements('EClass').filter((eClass) => {\n          return eClass.get('eSuperTypes').filter((eSuperType)=>{\n            return eType.get('name') == eSuperType.get('name');\n          }).length > 0;\n        });\n        var superTypeNames = superTypes.map((superType)=>{\n          return superType.get('name');\n        });\n        return {\n          name: asso.get('name'),\n          eTypes: superTypeNames\n        }\n      }else{\n        return {\n          name: asso.get('name'),\n          eTypes: [eType.get('name')]\n        }\n      }\n  \t});\n  \tthis.setState({\n  \t\tcontainments: containments,\n      selectedContainment: containments[0].name\n  \t});\n  },\n\n  onAssociationChange: function() {\n    let association = this.refs.association.value;\n    let selectedContainment = association;\n    this.setState({\n      selectedContainment: selectedContainment\n    });\n  },\n\n  render: function() {\n  \tvar options = this.state.containments.map(function(containment) {\n  \t\treturn (<option key={'createmodal-'+containment.name}>{containment.name}</option>);\n  \t});\n    var containment = this.state.containments.filter((containment) => {\n      return containment.name == this.state.selectedContainment\n    })[0];\n    var options2 = containment?(containment.eTypes.map(function(eTypeName) {\n      return (<option key={'createmodal-'+eTypeName}>{eTypeName}</option>);\n    })):(<div/>);\n\n    return (\n      <div>\n        <Modal\n          isOpen={this.props.isOpen}\n          onAfterOpen={this.afterOpenModal}\n          onRequestClose={this.closeModal}\n          style={customStyles} >\n\n          <h2>インスタンス作成</h2>\n          <div className=\"core-modal-form\">\n            <span className=\"core-modal-form-label\">関連名</span>\n            <div className=\"core-modal-form-input\">\n              <select ref=\"association\" onChange={this.onAssociationChange}>{options}</select>\n            </div>\n          </div>\n          <div className=\"core-modal-form\">\n            <span className=\"core-modal-form-label\">クラス名</span>\n            <div className=\"core-modal-form-input\">\n              <select ref=\"eclass\" onChange={this.onAssociationChange}>{options2}</select>\n            </div>\n          </div>\n          <div className=\"core-modal-form\">\n            <span className=\"core-modal-form-label\">作成するオブジェクトの名前</span>\n            <div className=\"core-modal-form-input\">\n              <input ref=\"name\" type=\"text\" />\n            </div>\n          </div>\n          <button onClick={this.okModal}>OK</button>\n          <button onClick={this.closeModal}>Cancel</button>\n        </Modal>\n      </div>\n    );\n  }\n});\n\nmodule.exports = CreateModal;"]}